sheet1

Dim aliveCounter As Integer

Sub UpdateView()
Cells(1, 1) = aliveCounter
aliveCounter = aliveCounter + 1


End Sub



workbook

Private Sub Workbook_BeforeClose(Cancel As Boolean)
    Module1.StopTimer
    Module1.Dispose
End Sub

Private Sub Workbook_Open()
    Module1.Init
    Module1.StartTimer
End Sub





Module1

Dim client As TeslaComClient.Main
Public RunWhen As Double
Public Const cRunWhat = "TimerCall"



Sub Init()
    If client Is Nothing Then
        Set client = New TeslaComClient.Main
    End If
End Sub
Sub Dispose()
    If Not (client Is Nothing) Then
        client.Dispose
    End If
End Sub

Sub Iiaee??eouny()
    If client Is Nothing Then
        Set client = New TeslaComClient.Main
        
        
        
    End If
    
    Dim connected As Boolean
    connected = client.Connect(Cells(2, 1))
    MsgBox connected
End Sub














Sub StartTimer()
RunWhen = Now + TimeSerial(0, 0, 1)
Application.OnTime earliesttime:=RunWhen, procedure:=cRunWhat, _
     schedule:=True
End Sub

Sub StopTimer()
   On Error Resume Next
   Application.OnTime earliesttime:=RunWhen, _
       procedure:=cRunWhat, schedule:=False
End Sub

Sub TimerCall()
    Eeno1.UpdateView
    Call StartTimer
End Sub


